<html>
<head>
	<title>Townforge | Map</title>
	<link rel="stylesheet" href="./dist/leaflet.css"/>
<!-- Make sure you put this AFTER Leaflet's CSS -->
	<script src="./dist/leaflet.js"></script>

<!-- https://github.com/ablakey/Leaflet.SimpleGraticule --> 
	<link rel="stylesheet" href="./dist/L.SimpleGraticule.css" />
	<script src="./dist/L.SimpleGraticule.js"></script>
<!-- https://github.com/ablakey/Leaflet.SimpleGraticule --> 

<!-- https://github.com/BenPortner/leaflet-burgermenu --> 
	<link rel="stylesheet" href="./dist/leaflet-burgermenu.css"/>
	<script src="./dist/leaflet-burgermenu.umd.min.js"></script>
<!-- https://github.com/BenPortner/leaflet-burgermenu -->

<!-- Autocomplete on forms --> 
	<link rel="stylesheet" href="./dist/my-autocomplete.css"/>
	<script src="./dist/my-autocomplete.js"></script>
	<!-- function runAutocomplete() {
	/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
	autocomplete(document.getElementById("myInput"), countries); 
	/*An array containing all the country names in the world:*/
	var countries = ["Afghanistan","Albania","Yemen","Zambia","Zimbabwe"];
	-->
<!-- Autocomplete on forms --> 
<style>
#map {
	height: 100%;
	width:  100%;
	background: none;
}
.popup_table {
	white-space: nowrap;
}
/*<!-- .popup_without_tip .leaflet-popup-tip   first value add/edit second already defined value--> */
.popup_without_tip .leaflet-popup-tip {
	display: none;
}
/*<!-- info box top right--> */
.info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } 
.info h4 { margin: 0 0 5px; color: #777; }
/*<!-- info box top right-->*/

/*<!-- info legend bottom right-->*/
.circle_repair {
	line-height: 22px;
	width: 45px;
	border-radius: 15%;
	white-space: nowrap;
	text-align: center;
}
.circle_role {
	line-height: 22px;
	width: 115px;
	border-radius: 15%;
	white-space: nowrap;
	text-align: center;
}
.circle_EP {
	line-height: 22px;
	width: 55px;
	border-radius: 15%;
	white-space: nowrap;
	text-align: center;
}
.br_legend {
	line-height: 0.2;
}
/*<!-- info legend bottom right-->*/

/*<!-- Pulsing Marker -->*/
.css-icon {
}
.gps_ring {
	border: 3px solid #999;
	-webkit-border-radius: 30px;
	height: 18px;
	width: 18px;
	-webkit-animation: pulsate 1s ease-out;
	-webkit-animation-iteration-count: infinite; 
	/*opacity: 0.0*/
}
@-webkit-keyframes pulsate {
	0% {-webkit-transform: scale(0.1, 0.1); opacity: 0.0;}
	50% {opacity: 1.0;}
	100% {-webkit-transform: scale(1.2, 1.2); opacity: 0.0;}
}
/*<!-- Pulsing Marker -->*/
/*<!-- Home Button -->*/
#HomeButton{
	display: flex;
	align-items: center;
	position: absolute;
	bottom: 27px;
	left: 45px;
	width: 32px;
	height: 32px;
	background-color: white;
	border-radius: 5px;
	border-color: gray;
	border-style: solid;
	border-width: 1px 1px 1px 1px;
	opacity: 0.8;
	text-align: center;
	z-index: 1000;
	justify-content: center;
	align-items: center;
}
#HomeButton:hover{
	opacity: 1;
	cursor: pointer;
}
/*<!-- Home Button -->*/
/*<!-- Edit Button -->*/
#Calculate_influence_button{
	display: flex;
	align-items: center;
	position: absolute;
	bottom: 27px;
	left: 80px;
	width: 70px;
	height: 32px;
	background-color: white;
	border-radius: 5px;
	border-color: gray;
	border-style: solid;
	border-width: 1px 1px 1px 1px;
	opacity: 0.8;
	text-align: center;
	z-index: 1000;
	justify-content: center;
	align-items: center;
}
#Calculate_influence_button:hover{
	opacity: 1;
	cursor: pointer;
}
/*<!-- Edit Button -->*/
tr:nth-child(even) {
	/*Use an rgba() color to specify the transparency of the color:*/
	background-color: rgba(117, 117, 117, 0.1);
}

</style>
</head>

<body>
<div id="map">
	<!-- Home Button -->
	<button id="HomeButton" title='Reset Map View' onclick='map.setView( [0, 0], -1);'>
	<img src="./dist/home.svg" style="width:20px;"></img>
	</button>
	<!-- Home Button -->
	<!-- Edit Button -->
	<button id="Calculate_influence_button" title='Calculate Influence of Flags on Selection' style="line-height: 1;"
		onclick='
			if (map.hasLayer(featureGroup_Legend) == 0) {
				document.getElementById("Calculate_influence_button").style.background="Lime";
				document.getElementById("Calculate_influence_button").style.border="2px solid Green";
				featureGroup_Legend.addTo(map).clearLayers();
				legend_Influence_calculator.addTo(map);
				legend_role.remove();
				legend_repair.remove();
				legend_owner.remove();
				legend_EcoPow.remove();
				}
			else if (map.hasLayer(featureGroup_Legend) == 1) {
				document.getElementById("Calculate_influence_button").style.background="White";
				document.getElementById("Calculate_influence_button").style.border="1px solid Gray";
				featureGroup_Legend.remove();
				legend_Influence_calculator.remove();
				if (map.hasLayer(featureGroup_role) == 1) {legend_role.addTo(map)};
				if (map.hasLayer(featureGroup_repair) == 1) {legend_repair.addTo(map)};
				if (map.hasLayer(featureGroup_owner) == 1) {legend_owner.addTo(map)};
				if (map.hasLayer(featureGroup_EcoPow) == 1) {legend_EcoPow.addTo(map)};
				}
			'>
	Influence Calculator 
	</button>
	<!-- Edit Button -->
</div>
<script type="text/javascript" src="GeoJSON_Flags_data.js"></script>
<script type="text/javascript" src="Account_data.js"></script>
<script type="text/javascript" src="./dist/mine_calculate_flag_influence.js"></script>
<script>
function getColor_role(d) {
	return  d == 0  ? "white"  :
			d == 1  ? "LawnGreen"  :
			d == 2  ? "Cyan"  :
			d == 3  ? "SaddleBrown"  :
			d == 4  ? "Magenta"  :
			d == 5  ? "Orange"  :
			d == 6  ? "DarkOrange"  :
			d == 7  ? "OrangeRed"  :
			d == 8  ? "DarkSlateGray"  :
			d == 9  ? "MediumSlateBlue"  :
			d == 10 ? "Silver" :
			d == 11 ? "ForestGreen" :
			d == 12 ? "SandyBrown" :
			d == 13 ? "Tan" :
			d == 14 ? "NavajoWhite" :
			d == 15 ? "DimGray" :
			d == 16 ? "RebeccaPurple" :
			d == 17 ? "RoyalBlue" : "white" ;
	}

function getColor_active(d) {
	return  d == "true"  ? "Green"	:
			d == "false" ? "Red"	: "white" ;
	}
                        
function getColor_repair(d) {
	return  d > 70 ? "Chartreuse"		:
			d > 60 ? "LightSalmon"		:
			d > 50 ? "Coral"			:
			d > 40 ? "Tomato"			:
			d > 30 ? "OrangeRed"		:
			d > 20 ? "MediumPurple" 	:
			d >  0 ? "RebeccaPurple"	:
			d == 0 ? "white"			: "white" ;
	}
                        
function getColor_owner(str) {
	let sum = 0;
	for (let i = 0; i < str.length; i++) {
		sum += str.charCodeAt(i);
		}
	// map the sum to RGB by splitting it into three parts
	const r = (sum * 7) % 256; // change number in "sum * 7" to get different color, it must be prime number 
	const g = (sum * 41) % 256; // prime numbers: 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97
	const b = (sum * 67) % 256; //
	return `#${[r, g, b]
	.map((x) => x.toString(16).padStart(2, '0'))
	.join('')}`;
}                        

function getColor_Economic_Power(d) {
	return  d == 300 ? "#0AF51A"	:
			d >  250 ? "#23AC1F"	:
			d >  200 ? "#22681B"	:
			d >  150 ? "#F58F0A"	:
			d >  100 ? "#AD6614"	:
			d == 100 ? "#694014"	: "white" ;
	}

function Style_Normal(feature) {
		return {
			weight: 1,
			opacity: 1,
			color: getColor_active(feature.properties.active),
			dashArray: '4',
			fillOpacity: 0.8,
			fillColor: getColor_role(feature.properties.role)
		};
	}
	
function Style_Repair(feature) {
		return {
			weight: 1,
			opacity: 1,
			color: getColor_active(feature.properties.active),
			dashArray: '4',
			fillOpacity: 0.8,
			fillColor: getColor_repair(feature.properties.repair)
	};
}

function Style_Owner(feature) {
		return {
			weight: 1,
			opacity: 1,
			color: getColor_active(feature.properties.active),
			dashArray: '4',
			fillOpacity: 0.8,
			fillColor: getColor_owner(ACCOUNT_NAME[feature.properties.owner])
	};
}

function Style_Economic_Power(feature) {
		return {
			weight: 1,
			opacity: 1,
			color: getColor_active(feature.properties.active),
			dashArray: '4',
			fillOpacity: 0.8,
			fillColor: getColor_Economic_Power(feature.properties.economic_power)
	};
}

function function_highlightFeature(e) {
		const layer = e.target;

		layer.setStyle({
			weight: 7,
			dashArray: '',
			fillOpacity: 0.8
		});
		layer.bringToFront();
		info.update(layer.feature);
		
		if (featureGroup_InfluenceMouseOver_ON == true) {
			if (layer.feature.properties.role != 0) {
				const influence = Number(layer.feature.properties.influence)
				const coordinates = [
					[
						xy((layer.feature.geometry.coordinates[0][0][0]) - influence,(layer.feature.geometry.coordinates[0][0][1]) - influence),
						xy((layer.feature.geometry.coordinates[0][1][0]) + influence,(layer.feature.geometry.coordinates[0][1][1]) - influence),
						xy((layer.feature.geometry.coordinates[0][2][0]) + influence,(layer.feature.geometry.coordinates[0][2][1]) + influence),
						xy((layer.feature.geometry.coordinates[0][3][0]) - influence,(layer.feature.geometry.coordinates[0][3][1]) + influence),
					],
					[xy(layer.feature.geometry.coordinates[0][0]),xy(layer.feature.geometry.coordinates[0][1]),xy(layer.feature.geometry.coordinates[0][2]),xy(layer.feature.geometry.coordinates[0][3])]
				]
				Influence_Rectangle_MouseOver = L.polygon( coordinates, {weight: 0, fillColor: 'LimeGreen', fillOpacity: 0.4, interactive: false}).addTo(featureGroup_InfluenceMouseOver);
			}
		}
	}	
	
function function_resetHighlight(e) {
		const layer = e.target;

		layer.setStyle({
			weight: 1,
			dashArray: '4',
			fillOpacity: 0.8
		});
		layer.bringToBack();
		info.update();
		
		if (featureGroup_InfluenceMouseOver_ON == true) {
			Influence_Rectangle_MouseOver.removeFrom(featureGroup_InfluenceMouseOver)
		}
	}
  
function onEachFeature(feature, layer) {	
		layer.on({	
			mouseover: function_highlightFeature,	
			mouseout: function_resetHighlight,	
		});
		var popup_text=(`<table class='popup_table'><tr><td>Name:</td><td><b>${feature.properties.name}</b></td></tr><tr><td>Owner:</td><td>${ACCOUNT_NAME[feature.properties.owner]}</td></tr><tr><td>House:</td><td>${ACCOUNT_HOUSE[feature.properties.owner]}</td></tr><tr><td>Role:</td><td>${FLAG_ROLE_NAME[feature.properties.role]}</td></tr><tr><td>Active:</td><td>${feature.properties.active}</td></tr><tr><td>Flag ID:</td><td>${feature.id}</td></tr><tr><td>Size: </td><td>${feature.properties.size}</td></tr><tr><td>Economic Power: </td><td>${feature.properties.economic_power} %</td></tr><tr><td>Repair: </td><td>${feature.properties.repair} %</td></tr></table>`)
		layer.bindPopup(popup_text,{maxWidth: 1000,});
	}

function getFlagIDFromName(value) {
	const allFlagsCities = [  Flags_city0, Flags_city1, Flags_city2, Flags_city3, Flags_city4,];
	for (const cityGeoJSON of allFlagsCities) {
		const feature = cityGeoJSON.features.find(f => f.properties.name === value);
		if (feature) {
			const log_message000210 = value
			const log_message000211 = ' : Name | ID : '
			const log_message000212 = feature.id
			log_message0002 = log_message000210 + log_message000211 + log_message000212
			console.log(log_message0002)
			return feature.id
			}
		}
	return null;
	}

function getFlagInfoFromID(value) {
	const allFlagsCities = [  Flags_city0, Flags_city1, Flags_city2, Flags_city3, Flags_city4,];
	for (const cityGeoJSON of allFlagsCities) {
		const feature = cityGeoJSON.features.find(f => f.id === value);
		if (feature) {
			let html =''
			html += '<table><tr><td>Name:</td><td><b>'
			html += feature.properties.name
			html += '</b></td></tr><tr><td>Owner:</td><td>'
			html += ACCOUNT_NAME[feature.properties.owner]
			html += '</b></td></tr><tr><td>House:</td><td>'
			html += ACCOUNT_HOUSE[feature.properties.owner]
			html += '</b></td></tr><tr><td>City:</td><td>'
			html += city_names[feature.properties.city]
			html += '</td></tr><tr><td>Role:</td><td>'
			html += FLAG_ROLE_NAME[feature.properties.role]
			html += '</td></tr><tr><td>Active:</td><td>'
			html += feature.properties.active
			html += '</td></tr><tr><td>Flag ID:</td><td>'
			html += feature.id
			html += '</td></tr><tr><td>Size: </td><td>'
			html += feature.properties.size
			html += '</td></tr><tr><td>Economic Power: </td><td>'
			html += feature.properties.economic_power
			html += ' %</td></tr><tr><td>Repair: </td><td>'
			html += feature.properties.repair
			html += ' %</td></tr></table>'
			return html;
			}
		}
	return null;
	}

function getAccountFromName(value) {
	const allFlagsCities = [  Flags_city0, Flags_city1, Flags_city2, Flags_city3, Flags_city4,];
	for (const cityGeoJSON of allFlagsCities) {
		const filteredFeatures = cityGeoJSON.features.filter(feature => ACCOUNT_NAME[feature.properties.owner] === value);
		const ids = filteredFeatures.map(feature => feature.id);
		let result = '';
		for (let i = 0; i < ids.length; i++) {
			result += ids[i];
			// Add comma after the item if it's not the last one
			if (i !== ids.length - 1) result += ', ';
			breakAfter = 10;
			// Insert <br> after every 'breakAfter' items, but not at the very end
			if ((i + 1) % breakAfter === 0 && i !== ids.length - 1) result += '<br>';
			}
		// Return the entire properties object if found, otherwise null
		if (result) {
			console.log(result);
			return result;
			}
		}
	return null;
	}

function Jump_to_Flag_from_ID(value) {
	const allFlagsCities = [  Flags_city0, Flags_city1, Flags_city2, Flags_city3, Flags_city4,];
	for (const cityGeoJSON of allFlagsCities) {
		// Use Array.prototype.find to locate the feature with the matching name property
		const feature = cityGeoJSON.features.find(f => f.id === value);
		if (feature) {
			var text = ""
			text += 'Jumped to Flag Id:' + value
			// If found, return the id, else return null or undefined
			const x = ( feature.geometry.coordinates[0][0][0] + ( ( feature.geometry.coordinates[0][2][0] - feature.geometry.coordinates[0][0][0] ) / 2 ));
			const y = ( feature.geometry.coordinates[0][0][1] + ( ( feature.geometry.coordinates[0][2][1] - feature.geometry.coordinates[0][0][1] ) / 2 ));
			const city = feature.properties.city
			BaseLayer_GeoJSON_City_0.removeFrom(map)
			BaseLayer_GeoJSON_City_1.removeFrom(map)
			BaseLayer_GeoJSON_City_2.removeFrom(map)
			BaseLayer_GeoJSON_City_3.removeFrom(map)
			BaseLayer_GeoJSON_City_4.removeFrom(map)
			if (city === '0') { BaseLayer_GeoJSON_City_0.addTo(map)}
			if (city === '1') { BaseLayer_GeoJSON_City_1.addTo(map)}
			if (city === '2') { BaseLayer_GeoJSON_City_2.addTo(map)}
			if (city === '3') { BaseLayer_GeoJSON_City_3.addTo(map)}
			if (city === '4') { BaseLayer_GeoJSON_City_4.addTo(map)}
			map.closePopup();
			map.removeLayer(SearchMarker);
			SearchMarker = new L.marker(xy([x, y])).on('click', function(e) { map.removeLayer(SearchMarker);});
			map.addLayer(SearchMarker);
			text1 = ""
			text1 += 'Flag ID ' + value
			SearchMarker.bindPopup(text1).openPopup();
			map.setView( xy([x, y]));
			return feature ? text : null;
			}
		}
	// If not found in any cities
	return null;
	}

function goToFlag1() {
	var x = document.getElementById('search_form_1');
	var text001 = '';
	text001 += 'Go To Flag Id: ' + x.elements[0].value
	console.log(text001);
	const log_message0001 = Jump_to_Flag_from_ID(x.elements[0].value);
	console.log(log_message0001);
	}

function goToFlag2() {
	var x = document.getElementById('search_form_2');
	var text001 = '';
	text001 += 'Go To Flag Name: ' + x.elements[0].value
	console.log(text001);
	const log_message0001 = Jump_to_Flag_from_ID(getFlagIDFromName(x.elements[0].value));
	console.log(log_message0001);
	}

function sendToConsole1() {                                 
	var x = document.getElementById('search_form_1');              
	var text = '<b>Results:</b>';                                                            
	text += getFlagInfoFromID(x.elements[0].value) + '<br>';
	document.getElementById("search_form_result1").innerHTML = text;
	document.getElementById("button01").disabled = false;
	console.log(x.elements[0].value);                                                     
	}

function sendToConsole2() {                                 
	var x = document.getElementById('search_form_2');
	console.log(x.elements[0].value);
	var text = '<b>Results:</b>';                                                            
	text += getFlagInfoFromID(getFlagIDFromName(x.elements[0].value)) + '<br>';
	document.getElementById("search_form_result2").innerHTML = text;
	document.getElementById("button02").disabled = false;
	}

function sendToConsole3() {                                 
	var x = document.getElementById('search_form_3');              
	var text = '<b>Owned Flags:</b><br>';                                                            
	text += getAccountFromName(x.elements[0].value) + '<br>';
	document.getElementById("search_form_result3").innerHTML = text;
	console.log(x.elements[0].value);                                                   
	}

function sendToConsole4() {                                 
	var x = document.getElementById('search_form_4');              
	var text = '<b>Owned Flags:</b><br>';                                                            
	text += getAccountFromName(x.elements[0].value) + '<br>';
	document.getElementById("search_form_result4").innerHTML = text;
	console.log(x.elements[0].value);                                                   
	}

function runAutocomplete_flag_id() {
	/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
	autocomplete(document.getElementById("myInput1"), all_flags);
	}

function runAutocomplete_flag_names() {
	/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
	autocomplete(document.getElementById("myInput2"), flag_names);
	}

function runAutocomplete_account_names() {
	/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
	autocomplete(document.getElementById("myInput3"), ACCOUNT_NAME);
	}

function runAutocomplete_house_names() {
	/*initiate the autocomplete function on the "myInput" element, and pass along the countries array as possible autocomplete values:*/
	autocomplete(document.getElementById("myInput4"), ACCOUNT_HOUSE);
	}
function generateTable(data, Value) {
	const entries = Object.entries(data).filter(([key, value]) => !isNaN(key) && Array.isArray(value));
	entries.sort((a,b) => Number(b[1][Value]) - Number(a[1][Value]));
	let html = `<table class='popup_table'>`;
	html += `<thead><tr><th colspan="3"><h2>${Account_data_fieldNames[Value]} Leaderboard</h2></th></tr></thead><tbody>`;
	html += `<thead><tr><td><u><b>House</b></u></td><td><u><b>Name</b></u></td><td><u><b>${Account_data_fieldNames[Value]}</b></u></td></tr></thead><tbody>`;
	for (const [index, accountArray] of entries) {
		html += `<tr><td>${ACCOUNT_HOUSE[index]}</td><td>${ACCOUNT_NAME[index]}</td><td align="right">${formatNumberWithDots(accountArray[Value])}</td></tr>`;
		}
	html += `</tbody></table>`;
	return html;
	}

function formatNumberWithDots(numberStr) {
	return numberStr.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
	}

function parseDate(str) {
	const [date, time] = str.split('_');
	const [year, month, day] = date.split('/').map(Number);
	const [hour, minute] = time.split(':').map(Number);
	return new Date(Date.UTC(year, month - 1, day, hour, minute));
	}
  
function update_tick_timer() {
	const now = new Date();
	let diff = target - now; // ms difference
	diff = Math.abs(diff);
	const totalSeconds = Math.floor(diff / 1000);
	const hours = Math.floor(totalSeconds / 3600);
	const minutes = Math.floor((totalSeconds % 3600) / 60);
	const seconds = totalSeconds % 60;
	timerEl.textContent =`Last update ${hours}h ${minutes}m ${seconds}s ago`;
	}

function function_select_first_marker(e) {
	L.DomEvent.addListener(map, 'click', this.function_select_first_marker_enterAddMarkerMode.bind(this));
}

function function_select_first_marker_enterAddMarkerMode () {
	Select_Ignore_interactive_map_Rectangle.addTo(map);
	document.getElementById("InfluenceButton1").style.background="Lime";
	document.getElementById("InfluenceButton1").style.border="1px solid Green";
	document.getElementById("InfluenceButton1").disabled = true;
	document.getElementById("InfluenceButton2").disabled = true;
	document.getElementById("InfluenceButton3").disabled = true;
	//this.map._container.style.cursor = 'crosshair';
	this.map.addEventListener('click', this.function_select_first_marker_onMapClickAddMarker.bind(this));
}

function function_select_first_marker_onMapClickAddMarker (e) {
	"use strict";
	Select_Ignore_interactive_map_Rectangle.remove();
	document.getElementById("InfluenceButton1").style.background="";
	document.getElementById("InfluenceButton1").style.border="";
	document.getElementById("InfluenceButton1").disabled = false;
	document.getElementById("InfluenceButton2").disabled = false;
	document.getElementById("InfluenceButton3").disabled = false;
	this.map.removeEventListener('click');
	//this.map._container.style.cursor = 'auto';
	marker_first.remove()
	marker_first = L.marker(e.latlng, {draggable: true})
	marker_first.addTo(featureGroup_Legend);
}

function function_select_second_marker(e) {
	L.DomEvent.addListener(map, 'click', this.function_select_second_marker_enterAddMarkerMode.bind(this));
}

function function_select_second_marker_enterAddMarkerMode () {
	Select_Ignore_interactive_map_Rectangle.addTo(map);
	document.getElementById("InfluenceButton2").style.background="Lime";
	document.getElementById("InfluenceButton2").style.border="1px solid Green";
	document.getElementById("InfluenceButton1").disabled = true;
	document.getElementById("InfluenceButton2").disabled = true;
	document.getElementById("InfluenceButton3").disabled = true;
	//this.map._container.style.cursor = 'crosshair';
	this.map.addEventListener('click', this.function_select_second_marker_onMapClickAddMarker.bind(this));
}

function function_select_second_marker_onMapClickAddMarker (e) {
	"use strict";
	Select_Ignore_interactive_map_Rectangle.remove();
	document.getElementById("InfluenceButton2").style.background="";
	document.getElementById("InfluenceButton2").style.border="";
	document.getElementById("InfluenceButton1").disabled = false;
	document.getElementById("InfluenceButton2").disabled = false;
	document.getElementById("InfluenceButton3").disabled = false;
	this.map.removeEventListener('click');
	//this.map._container.style.cursor = 'auto';
	marker_second.remove()
	marker_second = L.marker(e.latlng, {draggable: true})
	marker_second.addTo(featureGroup_Legend);
}

</script>
<script>
var map = L.map('map', {
	crs: L.CRS.Simple,
	minZoom: -5,
	maxZoom: 3,
	maxBoundsViscosity: 0.1,
	zoomControl: false, // i have it after attribution
	inertia: false,
	inertiaMaxSpeed: 1000,
	zoomAnimation: false,
	fadeAnimation: false,
});
map.getRenderer(map).options.padding = 100; // How much to extend the clip area around the map view (relative to its size) e.g. 0.1 would be 10% of map view in each direction

var SearchMarker = L.marker()
var Select_Ignore_interactive_map_Rectangle = L.rectangle([[-10000000, -10000000],[10000000, 10000000]], {color: "gray", weight: 0, fillOpacity: 0, interactive: true});
var Influence_Rectangle_MouseOver
let featureGroup_InfluenceMouseOver_ON = false

//<!-- Pulsing Marker -->
var cssIcon = L.divIcon({
	className: 'css-icon',
	html: '<div class="gps_ring"></div>'
	// Set marker width and height
	,iconSize: [22,22]
	// ,iconAnchor: [11,11]
});
//<!-- Pulsing Marker -->

//<!-- xy to yx to L.latLng -->
var yx = L.latLng;
var xy = function(x, y) {
	if (Array.isArray(x)) {    // When doing xy([x, y]);
		return yx(x[1], x[0]);
		}
	return yx(y, x);  // When doing xy(x, y);
};
//<!-- xy to yx to L.latLng -->

//<!--https://github.com/ablakey/Leaflet.SimpleGraticule --> 
var options = {
	interval: 20,
	showOriginLabel: true,
	redraw: 'move',
	zoomIntervals: [
		{start: -5, end: -4, interval: 2048},
		{start: -3, end: -3, interval: 1024},
		{start: -2, end: -2, interval: 512},
		{start: -1, end: -1, interval: 256},
		{start: 0, end: 1, interval: 128},
		{start: 2, end: 3, interval: 64}
	]
};
L.simpleGraticule(options).addTo(map);
//<!-- https://github.com/ablakey/Leaflet.SimpleGraticule --> 
map.setMaxBounds([[-55102,-55102], [55102,55102]]);
const all_flags = ["1","2","3","4","5","9","10","12","13","14","15","18","19","23","25","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","79","80","81","82","83","84","103","108","109","111","113","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","172","173","174","175","186","187","188","189","190","191","192","193","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","253","254","255","256","257","258","259","260","261","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576",] 
const account_ids = ["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38",] 
const ACCOUNT_NAME = ["","Sigrid Sigrúnarsdóttir","Game","Foreclosure","Helsengaard treasury","Meloun","L","Romer","Syksy","Rucknium","Avatar I","Avatar II grey","Avatar III fat","PotR","PotR jr","Avatar test","badjabber","A16","TFQuests","Avatar 4","Avatar V","Avatar 6","Avatar 7","Avatar 11","avatar 8","yaoxi","Island treasury","Avatar 12","Avatar 13","preland","Pauleheister","jdawg420","redcathode","jdawg42","njkdcskjnds sdfsdf dffse errerw treasury","ABC123 treasury","Happy Cook","Town treasury","avatar 9999",]
const ACCOUNT_HOUSE = ["","Sigrid Sigrúnarsdóttir","Game","Foreclosure","Helsengaard treasury","Meloun","L","Romer","Syksy","Rucknium","Avatar I","Avatar II grey","Avatar III fat","PotR","PotR jr","Avatar test","badjabber","A16","TFQuests","Avatar 4","Avatar V","Avatar 6","Avatar 7","Avatar 11","avatar 8","yaoxi","Island treasury","Avatar 12","Avatar 13","preland","Pauleheister","jdawg420","redcathode","jdawg42","njkdcskjnds sdfsdf dffse errerw treasury","ABC123 treasury","Happy Cook","Town treasury","avatar 9999",]
const city_names = ["Helsengaard","Island","njkdcskjnds sdfsdf dffse errerw","ABC123","Town",]
const FLAG_ROLE_NAME = ["","agricultural","craft","industrial","commercial","basic residential","affluent residential","luxury residential","military","cultural","stonecutter","sawmill","kiln","smelter","workforce","road","research","fishery",]
const flag_names = ["Helsengaard town square","Tower","North Road","farm","Agricultural Field","Chop Chop on the Beach","East Street I","Cityside Gardens","Fishing Pier","Cityside Longhaus","Hare house","Icecrack Shack","Ugly Field","North side road","Syyskuunian Crafts","Western Road I","Helsengaard Park","Syysstad Imports & Exports","South-East Alleyway","East Street II","House by the Sea","Nice field","Big House","Work Bunks","Downtown Pad","Seaside Road II","Seaside Road I","Boat Builders","Seaside Road III","Syyskuunian Docks","Oats are good for you","Cow Paradise","Bad sawmill","Weird Table","Island town square","cfgvbbbbbbbvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv","House 2","house2","Syysstad Embassy","Syystadt Embassy Gardens","Tuorla, Helsengaard Observatory","njkdcskjnds sdfsdf dffse errerw town square","ABC123 town square","dfg","sdf","retert","fdgdfg","dsfsd","dsfgs","sdfsfd","erterter","dgfg","sdfsdf","aweawed","sdfsdfsdf","fdgdgf","ztutzutz","fgfg","59549459","59595959595959","Town town square","BIG HOUSE",]

const BaseLayer_GeoJSON_City_0 = L.geoJson([]).addTo(map);
const Layer_img_inactive_flags0 = L.featureGroup([]).addTo(BaseLayer_GeoJSON_City_0);
const Layer_img_role_flags0 = L.featureGroup([]);
const GeoJSON_Flags_Role_City_0 = L.geoJson(Flags_city0, {
		style: Style_Normal,
		onEachFeature
	})
const GeoJSON_Flags_Repair_City_0 = L.geoJson(Flags_city0, {
		style: Style_Repair,
		onEachFeature
	})
const GeoJSON_Flags_Owner_City_0 = L.geoJson(Flags_city0, {
		style: Style_Owner,
		onEachFeature
	})
const GeoJSON_Flags_EcoPow_City_0 = L.geoJson(Flags_city0, {
		style: Style_Economic_Power,
		onEachFeature
	})


const BaseLayer_GeoJSON_City_1 = L.geoJson([])
const Layer_img_inactive_flags1 = L.featureGroup([]).addTo(BaseLayer_GeoJSON_City_1);
const Layer_img_role_flags1 = L.featureGroup([]);
const GeoJSON_Flags_Role_City_1 = L.geoJson(Flags_city1, {
		style: Style_Normal,
		onEachFeature
	})
const GeoJSON_Flags_Repair_City_1 = L.geoJson(Flags_city1, {
		style: Style_Repair,
		onEachFeature
	})
const GeoJSON_Flags_Owner_City_1 = L.geoJson(Flags_city1, {
		style: Style_Owner,
		onEachFeature
	})
const GeoJSON_Flags_EcoPow_City_1 = L.geoJson(Flags_city1, {
		style: Style_Economic_Power,
		onEachFeature
	})


const BaseLayer_GeoJSON_City_2 = L.geoJson([])
const Layer_img_inactive_flags2 = L.featureGroup([]).addTo(BaseLayer_GeoJSON_City_2);
const Layer_img_role_flags2 = L.featureGroup([]);
const GeoJSON_Flags_Role_City_2 = L.geoJson(Flags_city2, {
		style: Style_Normal,
		onEachFeature
	})
const GeoJSON_Flags_Repair_City_2 = L.geoJson(Flags_city2, {
		style: Style_Repair,
		onEachFeature
	})
const GeoJSON_Flags_Owner_City_2 = L.geoJson(Flags_city2, {
		style: Style_Owner,
		onEachFeature
	})
const GeoJSON_Flags_EcoPow_City_2 = L.geoJson(Flags_city2, {
		style: Style_Economic_Power,
		onEachFeature
	})


const BaseLayer_GeoJSON_City_3 = L.geoJson([])
const Layer_img_inactive_flags3 = L.featureGroup([]).addTo(BaseLayer_GeoJSON_City_3);
const Layer_img_role_flags3 = L.featureGroup([]);
const GeoJSON_Flags_Role_City_3 = L.geoJson(Flags_city3, {
		style: Style_Normal,
		onEachFeature
	})
const GeoJSON_Flags_Repair_City_3 = L.geoJson(Flags_city3, {
		style: Style_Repair,
		onEachFeature
	})
const GeoJSON_Flags_Owner_City_3 = L.geoJson(Flags_city3, {
		style: Style_Owner,
		onEachFeature
	})
const GeoJSON_Flags_EcoPow_City_3 = L.geoJson(Flags_city3, {
		style: Style_Economic_Power,
		onEachFeature
	})


const BaseLayer_GeoJSON_City_4 = L.geoJson([])
const Layer_img_inactive_flags4 = L.featureGroup([]).addTo(BaseLayer_GeoJSON_City_4);
const Layer_img_role_flags4 = L.featureGroup([]);
const GeoJSON_Flags_Role_City_4 = L.geoJson(Flags_city4, {
		style: Style_Normal,
		onEachFeature
	})
const GeoJSON_Flags_Repair_City_4 = L.geoJson(Flags_city4, {
		style: Style_Repair,
		onEachFeature
	})
const GeoJSON_Flags_Owner_City_4 = L.geoJson(Flags_city4, {
		style: Style_Owner,
		onEachFeature
	})
const GeoJSON_Flags_EcoPow_City_4 = L.geoJson(Flags_city4, {
		style: Style_Economic_Power,
		onEachFeature
	})

const featureGroup_firefighting = L.featureGroup([]);
const featureGroup_tax_break_points = L.featureGroup([]);
const featureGroup_role_images = L.featureGroup([]).addTo(map);
const featureGroup_role = L.featureGroup([]).addTo(map);
const featureGroup_repair = L.featureGroup([]);
const featureGroup_owner = L.featureGroup([]);
const featureGroup_EcoPow = L.featureGroup([]);
const featureGroup_Legend = L.featureGroup([]);
const featureGroup_InfluenceMouseOver = L.featureGroup([]);
featureGroup_role.on('add',(e)=>{if (map.hasLayer(featureGroup_Legend) == 0) {legend_role.addTo(map)}});
featureGroup_role.on('remove',(e)=>{legend_role.remove()});
featureGroup_repair.on('add',(e)=>{if (map.hasLayer(featureGroup_Legend) == 0) {legend_repair.addTo(map)}});
featureGroup_repair.on('remove',(e)=>{legend_repair.remove()});
featureGroup_owner.on('add',(e)=>{if (map.hasLayer(featureGroup_Legend) == 0) {legend_owner.addTo(map)}});
featureGroup_owner.on('remove',(e)=>{legend_owner.remove()});
featureGroup_EcoPow.on('add',(e)=>{if (map.hasLayer(featureGroup_Legend) == 0) {legend_EcoPow.addTo(map)}});
featureGroup_EcoPow.on('remove',(e)=>{legend_EcoPow.remove()});
featureGroup_InfluenceMouseOver.on('add',(e)=>{featureGroup_InfluenceMouseOver_ON = true});
featureGroup_InfluenceMouseOver.on('remove',(e)=>{featureGroup_InfluenceMouseOver_ON = false});
const Layer_firefighting_city_0 = L.layerGroup([]).addTo(featureGroup_firefighting);
const Layer_tax_break_points_city_0 = L.layerGroup([]).addTo(featureGroup_tax_break_points);
BaseLayer_GeoJSON_City_0.on('add',(e)=>{
	Layer_firefighting_city_0.addTo(featureGroup_firefighting);
	Layer_tax_break_points_city_0.addTo(featureGroup_tax_break_points);
	Layer_img_role_flags0.addTo(featureGroup_role_images);
	BaseLayer_GeoJSON_City_0.bringToBack();
	});
BaseLayer_GeoJSON_City_0.on('remove',(e)=>{
	Layer_firefighting_city_0.removeFrom(featureGroup_firefighting);
	Layer_tax_break_points_city_0.removeFrom(featureGroup_tax_break_points);
	Layer_img_role_flags0.removeFrom(featureGroup_role_images);
	map.removeLayer(SearchMarker);
	});
featureGroup_role.on('add',(e)=>{GeoJSON_Flags_Role_City_0.addTo(BaseLayer_GeoJSON_City_0).bringToBack();});
GeoJSON_Flags_Role_City_0.addTo(BaseLayer_GeoJSON_City_0)
featureGroup_role.on('remove',(e)=>{GeoJSON_Flags_Role_City_0.removeFrom(BaseLayer_GeoJSON_City_0);});
featureGroup_repair.on('add',(e)=>{GeoJSON_Flags_Repair_City_0.addTo(BaseLayer_GeoJSON_City_0).bringToBack();});
featureGroup_repair.on('remove',(e)=>{GeoJSON_Flags_Repair_City_0.removeFrom(BaseLayer_GeoJSON_City_0);});
featureGroup_owner.on('add',(e)=>{GeoJSON_Flags_Owner_City_0.addTo(BaseLayer_GeoJSON_City_0).bringToBack();});
featureGroup_owner.on('remove',(e)=>{GeoJSON_Flags_Owner_City_0.removeFrom(BaseLayer_GeoJSON_City_0);});
featureGroup_EcoPow.on('add',(e)=>{GeoJSON_Flags_EcoPow_City_0.addTo(BaseLayer_GeoJSON_City_0).bringToBack();});
featureGroup_EcoPow.on('remove',(e)=>{GeoJSON_Flags_EcoPow_City_0.removeFrom(BaseLayer_GeoJSON_City_0);});
const Layer_firefighting_city_1 = L.layerGroup([]);
const Layer_tax_break_points_city_1 = L.layerGroup([]);
BaseLayer_GeoJSON_City_1.on('add',(e)=>{
	Layer_firefighting_city_1.addTo(featureGroup_firefighting);
	Layer_tax_break_points_city_1.addTo(featureGroup_tax_break_points);
	Layer_img_role_flags1.addTo(featureGroup_role_images);
	BaseLayer_GeoJSON_City_1.bringToBack();
	});
BaseLayer_GeoJSON_City_1.on('remove',(e)=>{
	Layer_firefighting_city_1.removeFrom(featureGroup_firefighting);
	Layer_tax_break_points_city_1.removeFrom(featureGroup_tax_break_points);
	Layer_img_role_flags1.removeFrom(featureGroup_role_images);
	map.removeLayer(SearchMarker);
	});
featureGroup_role.on('add',(e)=>{GeoJSON_Flags_Role_City_1.addTo(BaseLayer_GeoJSON_City_1).bringToBack();});
GeoJSON_Flags_Role_City_1.addTo(BaseLayer_GeoJSON_City_1)
featureGroup_role.on('remove',(e)=>{GeoJSON_Flags_Role_City_1.removeFrom(BaseLayer_GeoJSON_City_1);});
featureGroup_repair.on('add',(e)=>{GeoJSON_Flags_Repair_City_1.addTo(BaseLayer_GeoJSON_City_1).bringToBack();});
featureGroup_repair.on('remove',(e)=>{GeoJSON_Flags_Repair_City_1.removeFrom(BaseLayer_GeoJSON_City_1);});
featureGroup_owner.on('add',(e)=>{GeoJSON_Flags_Owner_City_1.addTo(BaseLayer_GeoJSON_City_1).bringToBack();});
featureGroup_owner.on('remove',(e)=>{GeoJSON_Flags_Owner_City_1.removeFrom(BaseLayer_GeoJSON_City_1);});
featureGroup_EcoPow.on('add',(e)=>{GeoJSON_Flags_EcoPow_City_1.addTo(BaseLayer_GeoJSON_City_1).bringToBack();});
featureGroup_EcoPow.on('remove',(e)=>{GeoJSON_Flags_EcoPow_City_1.removeFrom(BaseLayer_GeoJSON_City_1);});
const Layer_firefighting_city_2 = L.layerGroup([]);
const Layer_tax_break_points_city_2 = L.layerGroup([]);
BaseLayer_GeoJSON_City_2.on('add',(e)=>{
	Layer_firefighting_city_2.addTo(featureGroup_firefighting);
	Layer_tax_break_points_city_2.addTo(featureGroup_tax_break_points);
	Layer_img_role_flags2.addTo(featureGroup_role_images);
	BaseLayer_GeoJSON_City_2.bringToBack();
	});
BaseLayer_GeoJSON_City_2.on('remove',(e)=>{
	Layer_firefighting_city_2.removeFrom(featureGroup_firefighting);
	Layer_tax_break_points_city_2.removeFrom(featureGroup_tax_break_points);
	Layer_img_role_flags2.removeFrom(featureGroup_role_images);
	map.removeLayer(SearchMarker);
	});
featureGroup_role.on('add',(e)=>{GeoJSON_Flags_Role_City_2.addTo(BaseLayer_GeoJSON_City_2).bringToBack();});
GeoJSON_Flags_Role_City_2.addTo(BaseLayer_GeoJSON_City_2)
featureGroup_role.on('remove',(e)=>{GeoJSON_Flags_Role_City_2.removeFrom(BaseLayer_GeoJSON_City_2);});
featureGroup_repair.on('add',(e)=>{GeoJSON_Flags_Repair_City_2.addTo(BaseLayer_GeoJSON_City_2).bringToBack();});
featureGroup_repair.on('remove',(e)=>{GeoJSON_Flags_Repair_City_2.removeFrom(BaseLayer_GeoJSON_City_2);});
featureGroup_owner.on('add',(e)=>{GeoJSON_Flags_Owner_City_2.addTo(BaseLayer_GeoJSON_City_2).bringToBack();});
featureGroup_owner.on('remove',(e)=>{GeoJSON_Flags_Owner_City_2.removeFrom(BaseLayer_GeoJSON_City_2);});
featureGroup_EcoPow.on('add',(e)=>{GeoJSON_Flags_EcoPow_City_2.addTo(BaseLayer_GeoJSON_City_2).bringToBack();});
featureGroup_EcoPow.on('remove',(e)=>{GeoJSON_Flags_EcoPow_City_2.removeFrom(BaseLayer_GeoJSON_City_2);});
const Layer_firefighting_city_3 = L.layerGroup([]);
const Layer_tax_break_points_city_3 = L.layerGroup([]);
BaseLayer_GeoJSON_City_3.on('add',(e)=>{
	Layer_firefighting_city_3.addTo(featureGroup_firefighting);
	Layer_tax_break_points_city_3.addTo(featureGroup_tax_break_points);
	Layer_img_role_flags3.addTo(featureGroup_role_images);
	BaseLayer_GeoJSON_City_3.bringToBack();
	});
BaseLayer_GeoJSON_City_3.on('remove',(e)=>{
	Layer_firefighting_city_3.removeFrom(featureGroup_firefighting);
	Layer_tax_break_points_city_3.removeFrom(featureGroup_tax_break_points);
	Layer_img_role_flags3.removeFrom(featureGroup_role_images);
	map.removeLayer(SearchMarker);
	});
featureGroup_role.on('add',(e)=>{GeoJSON_Flags_Role_City_3.addTo(BaseLayer_GeoJSON_City_3).bringToBack();});
GeoJSON_Flags_Role_City_3.addTo(BaseLayer_GeoJSON_City_3)
featureGroup_role.on('remove',(e)=>{GeoJSON_Flags_Role_City_3.removeFrom(BaseLayer_GeoJSON_City_3);});
featureGroup_repair.on('add',(e)=>{GeoJSON_Flags_Repair_City_3.addTo(BaseLayer_GeoJSON_City_3).bringToBack();});
featureGroup_repair.on('remove',(e)=>{GeoJSON_Flags_Repair_City_3.removeFrom(BaseLayer_GeoJSON_City_3);});
featureGroup_owner.on('add',(e)=>{GeoJSON_Flags_Owner_City_3.addTo(BaseLayer_GeoJSON_City_3).bringToBack();});
featureGroup_owner.on('remove',(e)=>{GeoJSON_Flags_Owner_City_3.removeFrom(BaseLayer_GeoJSON_City_3);});
featureGroup_EcoPow.on('add',(e)=>{GeoJSON_Flags_EcoPow_City_3.addTo(BaseLayer_GeoJSON_City_3).bringToBack();});
featureGroup_EcoPow.on('remove',(e)=>{GeoJSON_Flags_EcoPow_City_3.removeFrom(BaseLayer_GeoJSON_City_3);});
const Layer_firefighting_city_4 = L.layerGroup([]);
const Layer_tax_break_points_city_4 = L.layerGroup([]);
BaseLayer_GeoJSON_City_4.on('add',(e)=>{
	Layer_firefighting_city_4.addTo(featureGroup_firefighting);
	Layer_tax_break_points_city_4.addTo(featureGroup_tax_break_points);
	Layer_img_role_flags4.addTo(featureGroup_role_images);
	BaseLayer_GeoJSON_City_4.bringToBack();
	});
BaseLayer_GeoJSON_City_4.on('remove',(e)=>{
	Layer_firefighting_city_4.removeFrom(featureGroup_firefighting);
	Layer_tax_break_points_city_4.removeFrom(featureGroup_tax_break_points);
	Layer_img_role_flags4.removeFrom(featureGroup_role_images);
	map.removeLayer(SearchMarker);
	});
featureGroup_role.on('add',(e)=>{GeoJSON_Flags_Role_City_4.addTo(BaseLayer_GeoJSON_City_4).bringToBack();});
GeoJSON_Flags_Role_City_4.addTo(BaseLayer_GeoJSON_City_4)
featureGroup_role.on('remove',(e)=>{GeoJSON_Flags_Role_City_4.removeFrom(BaseLayer_GeoJSON_City_4);});
featureGroup_repair.on('add',(e)=>{GeoJSON_Flags_Repair_City_4.addTo(BaseLayer_GeoJSON_City_4).bringToBack();});
featureGroup_repair.on('remove',(e)=>{GeoJSON_Flags_Repair_City_4.removeFrom(BaseLayer_GeoJSON_City_4);});
featureGroup_owner.on('add',(e)=>{GeoJSON_Flags_Owner_City_4.addTo(BaseLayer_GeoJSON_City_4).bringToBack();});
featureGroup_owner.on('remove',(e)=>{GeoJSON_Flags_Owner_City_4.removeFrom(BaseLayer_GeoJSON_City_4);});
featureGroup_EcoPow.on('add',(e)=>{GeoJSON_Flags_EcoPow_City_4.addTo(BaseLayer_GeoJSON_City_4).bringToBack();});
featureGroup_EcoPow.on('remove',(e)=>{GeoJSON_Flags_EcoPow_City_4.removeFrom(BaseLayer_GeoJSON_City_4);});
const allFlagsCities = [  Flags_city0, Flags_city1, Flags_city2, Flags_city3, Flags_city4,];
const Img_role = []
	Img_role[0] = './dist/inactive.svg'
	Img_role[1] = './dist/farm.svg'
	Img_role[2] = './dist/anvil.svg'
	Img_role[3] = ''
	Img_role[4] = './dist/shop.svg'
	Img_role[5] = './dist/tent.svg'
	Img_role[6] = './dist/longhouse.svg'
	Img_role[7] = './dist/castle.svg'
	Img_role[8] = './dist/sword.svg'
	Img_role[9] = './dist/beer.svg'
	Img_role[10] = './dist/stone.svg'
	Img_role[11] = './dist/tree.svg'
	Img_role[13] = ''
	Img_role[14] = './dist/slave.svg'
	Img_role[15] = ''
	Img_role[16] = './dist/research.svg'
	Img_role[17] = './dist/ship.svg'
const ti_city = [];
	ti_city[0] = Layer_img_inactive_flags0
	ti_city[1] = Layer_img_inactive_flags1
	ti_city[2] = Layer_img_inactive_flags2
	ti_city[3] = Layer_img_inactive_flags3
	ti_city[4] = Layer_img_inactive_flags4
const Generation_of_inactive_images = L.geoJson(allFlagsCities, {
		onEachFeature: function(feature, layer){
			if ( feature.properties.active == 'false' && feature.properties.role != 0 ) {
				L.imageOverlay(Img_role[0], [xy(feature.geometry.coordinates[0][0]),xy(feature.geometry.coordinates[0][2])]).addTo(ti_city[feature.properties.city])
	}}})
const t_city = [];
	t_city[0] = Layer_img_role_flags0
	t_city[1] = Layer_img_role_flags1
	t_city[2] = Layer_img_role_flags2
	t_city[3] = Layer_img_role_flags3
	t_city[4] = Layer_img_role_flags4
const Generation_of_role_images = L.geoJson(allFlagsCities, {
		onEachFeature: function(feature, layer){
			if ( feature.properties.active == 'true' && Img_role[feature.properties.role] != '' ) {
				L.imageOverlay(Img_role[feature.properties.role], [xy(feature.geometry.coordinates[0][0]),xy(feature.geometry.coordinates[0][2])]).addTo(t_city[feature.properties.city])
	}}})

L.rectangle([xy([-1115, -2008]),xy([1459, 581])], {color: 'DarkSlateGray',fillColor: 'LightGreen', weight: 3, fillOpacity: 0.5, interactive: false}).addTo(Layer_firefighting_city_0);
L.rectangle([xy([-4170, -5829]),xy([7019, 5360])], {color: 'DarkSlateGray',fillColor: 'LightGreen', weight: 3, fillOpacity: 0.5, interactive: false}).addTo(Layer_firefighting_city_0);
L.rectangle([xy([72, -50]),xy([507, 387])], {color: 'DarkSlateGray',fillColor: 'LightGreen', weight: 3, fillOpacity: 0.5, interactive: false}).addTo(Layer_firefighting_city_0);
L.rectangle([xy([-2772, -2278]),xy([2294, 2795])], {color: 'DarkSlateGray',fillColor: 'LightGreen', weight: 3, fillOpacity: 0.5, interactive: false}).addTo(Layer_firefighting_city_1);

L.marker(xy([0, 0])).addTo(Layer_tax_break_points_city_0);
L.marker(xy([0, 0]), {icon: cssIcon}).addTo(Layer_tax_break_points_city_0);
L.marker(xy([0, 0])).addTo(Layer_tax_break_points_city_1);
L.marker(xy([0, 0]), {icon: cssIcon}).addTo(Layer_tax_break_points_city_1);
L.marker(xy([24962, 16852])).addTo(Layer_tax_break_points_city_1);
L.marker(xy([24962, 16852]), {icon: cssIcon}).addTo(Layer_tax_break_points_city_1);
L.marker(xy([3460, 449])).addTo(Layer_tax_break_points_city_1);
L.marker(xy([3460, 449]), {icon: cssIcon}).addTo(Layer_tax_break_points_city_1);
L.marker(xy([0, 0])).addTo(Layer_tax_break_points_city_2);
L.marker(xy([0, 0]), {icon: cssIcon}).addTo(Layer_tax_break_points_city_2);
L.marker(xy([0, 0])).addTo(Layer_tax_break_points_city_3);
L.marker(xy([0, 0]), {icon: cssIcon}).addTo(Layer_tax_break_points_city_3);
L.marker(xy([0, 0])).addTo(Layer_tax_break_points_city_4);
L.marker(xy([0, 0]), {icon: cssIcon}).addTo(Layer_tax_break_points_city_4);
L.rectangle([xy([-7776, -6265]),xy([11447, 14509])], {color: 'Orange',fill: false, weight: 10}).bindPopup('No Flag is beyond this line').addTo(BaseLayer_GeoJSON_City_0);
L.rectangle([xy([-11783, -3748]),xy([51102, 17889])], {color: 'Orange',fill: false, weight: 10}).bindPopup('No Flag is beyond this line').addTo(BaseLayer_GeoJSON_City_1);
L.rectangle([xy([-1128, -1128]),xy([1127, 1127])], {color: 'Orange',fill: false, weight: 10}).bindPopup('No Flag is beyond this line').addTo(BaseLayer_GeoJSON_City_2);
L.rectangle([xy([-1128, -1128]),xy([1127, 1127])], {color: 'Orange',fill: false, weight: 10}).bindPopup('No Flag is beyond this line').addTo(BaseLayer_GeoJSON_City_3);
L.rectangle([xy([-1128, -1128]),xy([1127, 1127])], {color: 'Orange',fill: false, weight: 10}).bindPopup('No Flag is beyond this line').addTo(BaseLayer_GeoJSON_City_4);
//<!-- Info panel top right -->>
const info = L.control();

info.onAdd = function (map) {
		this._div = L.DomUtil.create('div', 'info');
		this.update();
		return this._div;
	};

info.update = function (f) {
		const contents = f ? `<table><tr><td align='right'><u>Flag ID</u></td></tr><tr><td align='right'> ${f.id}</td></tr><tr><td align='right'><u>Owner</u></td></tr><tr><td align='right'>${ACCOUNT_NAME[f.properties.owner]}</td></tr><tr><td align='right'><u>Flag Name</td></u></tr><tr><td align='right'>${f.properties.name}</td></tr></table>` : 'Hover over a Flag';
		this._div.innerHTML = `<h4 align='right'>Flag Info</h4>${contents}`;
	};

info.addTo(map);	
//<!-- Info panel top right -->>
map.attributionControl.setPosition('bottomleft')
map.attributionControl.setPrefix('<a href="https://www.townforge.net/">Townforge</a> | <abbr title="0.36.6.4-release |  Generated at 2025/08/09_00:14 UTC / Blockchain height: 1,323,020 | Update should be each game tick"><abbr id="timer">Loading...</abbr></abbr>')
const givenStr = "2025/08/09_00:14"// attribution tick timer
const target = parseDate(givenStr);// attribution tick timer
const timerEl = document.getElementById('timer');// attribution tick timer
update_tick_timer();// attribution tick timer
setInterval(update_tick_timer, 1000);// attribution tick timer
L.control.zoom({position:'bottomleft'}).addTo(map)
const legend_repair_text="<div style=\"background-color:Chartreuse\" class=\"circle_repair\">> 70%</div>   <br class='br_legend'><div style=\"background-color:LightSalmon\" class=\"circle_repair\">> 60%</div>  <br class='br_legend'><div style=\"background-color:Coral\" class=\"circle_repair\">> 50%</div>        <br class='br_legend'><div style=\"background-color:Tomato\" class=\"circle_repair\">> 40%</div>       <br class='br_legend'><div style=\"background-color:OrangeRed\" class=\"circle_repair\">> 30%</div>    <br class='br_legend'><div style=\"background-color:MediumPurple\" class=\"circle_repair\">> 20%</div> <br class='br_legend'><div style=\"background-color:RebeccaPurple\" class=\"circle_repair\">> 00%</div><br class='br_legend'><div style=\"background-color:white\" class=\"circle_repair\">= 00%</div>        "                                                                                    
const legend_repair = L.control({position: 'bottomright'});                          
legend_repair.onAdd = function (map) {
	const div = L.DomUtil.create('div', 'info legend');
	
	div.innerHTML = legend_repair_text;
	return div;
};

const legend_role_text="<div style=\"background-color:    white \" class=\"circle_role\">none                </div><br class='br_legend'><div style=\"background-color:LawnGreen \" class=\"circle_role\">agricultural        </div><br class='br_legend'><div style=\"background-color:Cyan \" class=\"circle_role\">craft               </div><br class='br_legend'><div style=\"background-color:SaddleBrown \" class=\"circle_role\">industrial          </div><br class='br_legend'><div style=\"background-color:Magenta \" class=\"circle_role\">commercial          </div><br class='br_legend'><div style=\"background-color:Orange \" class=\"circle_role\">basic residential   </div><br class='br_legend'><div style=\"background-color:DarkOrange \" class=\"circle_role\">affluent residential</div><br class='br_legend'><div style=\"background-color:OrangeRed \" class=\"circle_role\">luxury residential  </div><br class='br_legend'><div style=\"background-color:DarkSlateGray \" class=\"circle_role\">military            </div><br class='br_legend'><div style=\"background-color:MediumSlateBlue \" class=\"circle_role\">cultural            </div><br class='br_legend'><div style=\"background-color:Silver\" class=\"circle_role\">stonecutter         </div><br class='br_legend'><div style=\"background-color:ForestGreen\" class=\"circle_role\">sawmill             </div><br class='br_legend'><div style=\"background-color:SandyBrown\" class=\"circle_role\">kiln                </div><br class='br_legend'><div style=\"background-color:Tan\" class=\"circle_role\">smelter             </div><br class='br_legend'><div style=\"background-color:NavajoWhite\" class=\"circle_role\">workforce           </div><br class='br_legend'><div style=\"background-color:DimGray\" class=\"circle_role\">road                </div><br class='br_legend'><div style=\"background-color:RebeccaPurple\" class=\"circle_role\">research            </div><br class='br_legend'><div style=\"background-color:RoyalBlue\" class=\"circle_role\">fishery             </div>"

const legend_role = L.control({position: 'bottomright'});
legend_role.onAdd = function (map) {
	const div = L.DomUtil.create('div', 'info legend');
	div.innerHTML = legend_role_text;
	return div;
};       
//default view
legend_role.addTo(map);
        
const legend_owner_text="Colors are generated from account name"

const legend_owner = L.control({position: 'bottomright'});
legend_owner.onAdd = function (map) {
	const div = L.DomUtil.create('div', 'info legend');
	div.innerHTML = legend_owner_text;
	return div;
};

const legend_EcoPow_text="<div style=\"background-color:#0AF51A\" class=\"circle_EP\">= 300%</div><br class='br_legend'><div style=\"background-color:#23AC1F\" class=\"circle_EP\">> 250%</div><br class='br_legend'><div style=\"background-color:#22681B\" class=\"circle_EP\">> 200%</div><br class='br_legend'><div style=\"background-color:#F58F0A\" class=\"circle_EP\">> 150%</div><br class='br_legend'><div style=\"background-color:#AD6614\" class=\"circle_EP\">> 100%</div><br class='br_legend'><div style=\"background-color:#694014\" class=\"circle_EP\">= 100%</div>"
const legend_EcoPow = L.control({position: 'bottomright'});
legend_EcoPow.onAdd = function (map) {
	const div = L.DomUtil.create('div', 'info legend');
	div.innerHTML = legend_EcoPow_text;
	return div;
};

const legend_Influence_calculator_text="<b>Influence Calculator</b><ol><li><button id='InfluenceButton1' onclick='function_select_first_marker()'>Select first corner</button><li><button id='InfluenceButton2' onclick='function_select_second_marker()'>Select second corner</button><li><button id='InfluenceButton3' onclick='function_get_selection_influence()'>Calculate influence</button></ol>"
const legend_Influence_calculator = L.control({position: 'bottomright'});
legend_Influence_calculator.onAdd = function (map) {
	const div = L.DomUtil.create('div', 'info legend');
	div.innerHTML = legend_Influence_calculator_text;
	return div;
};

var baseMaps = {
'Helsengaard': BaseLayer_GeoJSON_City_0,
'Island': BaseLayer_GeoJSON_City_1,
'njkdcskjnds sdfsdf dffse errerw': BaseLayer_GeoJSON_City_2,
'ABC123': BaseLayer_GeoJSON_City_3,
'Town': BaseLayer_GeoJSON_City_4,
};
var baseMaps_overlays = {
'Firefighting range': featureGroup_firefighting,
'Tax break points': featureGroup_tax_break_points,
'Role images': featureGroup_role_images,
'Flag influence': featureGroup_InfluenceMouseOver,
};
var overlays = {
'Role': featureGroup_role,
'Repair': featureGroup_repair,
'Owner': featureGroup_owner,
'E.Power': featureGroup_EcoPow,
};
var overlays_overlays = {};
var layerControl = L.control.layers(baseMaps,baseMaps_overlays,{ collapsed:false, position:'topleft' }).addTo(map);
var layerControl = L.control.layers(overlays,overlays_overlays,{ collapsed:false, position:'topleft' }).addTo(map);
//<!-- https://github.com/BenPortner/leaflet-burgermenu --> 
L.control.burgerMenu({
	title: "Search Menu",
	menuIcon: "<img src='./dist/search.svg' style='width:20px;'>" ,
	menuItems: [
		{title: "Search Flag ID", onClick: () => { 
			var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip', autoClose: true, closeOnClick: false})
				.setLatLng(xy([0, 0]))
				.setContent("					<!--Make sure the form has the autocomplete function switched off:-->					<form id='search_form_1' autocomplete='off' >					<div class='autocomplete' style='width:300px;'>					<b>Flag ID:</b> <input onclick='runAutocomplete_flag_id()' id='myInput1' type='text' placeholder='1'>					</div></form>					<button  onclick='sendToConsole1()'>Search</button>					<p id='search_form_result1'></p>					<button  onclick='goToFlag1()' disabled='true' id='button01'>Go To Flag</button>					")
				.openOn(map);
			map.setView( [0, 0]);},
		},
		{title: "Search Flag Name", onClick: () => { 
			var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip', autoClose: true, closeOnClick: false})
				.setLatLng(xy([0, 0]))
				.setContent("					<!--Make sure the form has the autocomplete function switched off:-->					<form id='search_form_2' autocomplete='off' >					<div class='autocomplete' style='width:300px;'>					<b>Flag name:</b> <input onclick='runAutocomplete_flag_names()' id='myInput2' type='text' placeholder='Helsengaard town square'>					</div></form>					<button  onclick='sendToConsole2()'>Search</button>					<p id='search_form_result2'></p>					<button  onclick='goToFlag2()' disabled='true' id='button02'>Go To Flag</button>					")
				.openOn(map);
			map.setView( [0, 0]);},
		},
		{title: "Search Name", onClick: () => { 
			var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip', autoClose: true, closeOnClick: false})
				.setLatLng(xy([0, 0]))
				.setContent("					<!--Make sure the form has the autocomplete function switched off:-->					<form id='search_form_3' autocomplete='off' >					<div class='autocomplete' style='width:300px;'>					<b>Owner name:</b> <input onclick='runAutocomplete_account_names()' id='myInput3' type='text' placeholder='Sigrid Sigrúnarsdóttir'>					</div>					<p id='search_form_result3'></p>					</form>					<button  onclick='sendToConsole3()'>Search</button>					")
				.openOn(map);
			map.setView( [0, 0]);},
		},
		{title: "Search House", onClick: () => { 
			var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip', autoClose: true, closeOnClick: false})
				.setLatLng(xy([0, 0]))
				.setContent("					<!--Make sure the form has the autocomplete function switched off:-->					<form id='search_form_4' autocomplete='off' >					<div class='autocomplete' style='width:300px;'>					<b>House name:</b> <input onclick='runAutocomplete_house_names()' id='myInput4' type='text' placeholder='Sigrún'>					</div>					<p id='search_form_result4'></p>					</form>					<button  onclick='sendToConsole4()'>Search</button>					")
				.openOn(map);
			map.setView( [0, 0]);},
		},
	],
}).addTo(map);
//<!-- https://github.com/BenPortner/leaflet-burgermenu -->
//<!-- https://github.com/BenPortner/leaflet-burgermenu --> 
L.control.burgerMenu({
	title: "Info Menu",
	menuIcon: "<img src='./dist/info.svg' style='width:20px;'>" ,
	menuItems: [
	{ 
		title: "City info",
		menuItems: [
			
	{
	title: "Helsengaard",
	onClick: () => {
		var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'})
		.setLatLng(xy([0, 0]))
		.setContent("	<table class='popup_table'>	<tr><td>Name:</td><td><b>Helsengaard</b></td></tr>	<tr><td>ID:</td><td>0</td></tr>	<tr><td>Level (max):</td><td>6 (6)</td></tr>	<tr><td>Mayor</td><td>Sigrid Sigrúnarsdóttir</td></tr>	<tr><td>Citizens:</td><td>12</td></tr>	<tr><td>Flags:</td><td>441</td></tr>	<tr><td>Flags Inactive:</td><td>70</td></tr>	<tr><td>Flags Empty:</td><td>63</td></tr>	</table>"	)
		.openOn(map);
		},
	},
	{
	title: "Island",
	onClick: () => {
		var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'})
		.setLatLng(xy([0, 0]))
		.setContent("	<table class='popup_table'>	<tr><td>Name:</td><td><b>Island</b></td></tr>	<tr><td>ID:</td><td>1</td></tr>	<tr><td>Level (max):</td><td>5 (5)</td></tr>	<tr><td>Mayor</td><td>Meloun</td></tr>	<tr><td>Citizens:</td><td>2</td></tr>	<tr><td>Flags:</td><td>33</td></tr>	<tr><td>Flags Inactive:</td><td>4</td></tr>	<tr><td>Flags Empty:</td><td>3</td></tr>	</table>"	)
		.openOn(map);
		},
	},
	{
	title: "njkdcskjnds sdfsdf dffse errerw",
	onClick: () => {
		var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'})
		.setLatLng(xy([0, 0]))
		.setContent("	<table class='popup_table'>	<tr><td>Name:</td><td><b>njkdcskjnds sdfsdf dffse errerw</b></td></tr>	<tr><td>ID:</td><td>2</td></tr>	<tr><td>Level (max):</td><td>0 (0)</td></tr>	<tr><td>Mayor</td><td>Meloun</td></tr>	<tr><td>Citizens:</td><td>1</td></tr>	<tr><td>Flags:</td><td>1</td></tr>	<tr><td>Flags Inactive:</td><td>0</td></tr>	<tr><td>Flags Empty:</td><td>0</td></tr>	</table>"	)
		.openOn(map);
		},
	},
	{
	title: "ABC123",
	onClick: () => {
		var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'})
		.setLatLng(xy([0, 0]))
		.setContent("	<table class='popup_table'>	<tr><td>Name:</td><td><b>ABC123</b></td></tr>	<tr><td>ID:</td><td>3</td></tr>	<tr><td>Level (max):</td><td>0 (0)</td></tr>	<tr><td>Mayor</td><td>Meloun</td></tr>	<tr><td>Citizens:</td><td>1</td></tr>	<tr><td>Flags:</td><td>1</td></tr>	<tr><td>Flags Inactive:</td><td>0</td></tr>	<tr><td>Flags Empty:</td><td>0</td></tr>	</table>"	)
		.openOn(map);
		},
	},
	{
	title: "Town",
	onClick: () => {
		var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'})
		.setLatLng(xy([0, 0]))
		.setContent("	<table class='popup_table'>	<tr><td>Name:</td><td><b>Town</b></td></tr>	<tr><td>ID:</td><td>4</td></tr>	<tr><td>Level (max):</td><td>0 (0)</td></tr>	<tr><td>Mayor</td><td>Meloun</td></tr>	<tr><td>Citizens:</td><td>1</td></tr>	<tr><td>Flags:</td><td>1</td></tr>	<tr><td>Flags Inactive:</td><td>0</td></tr>	<tr><td>Flags Empty:</td><td>0</td></tr>	</table>"	)
		.openOn(map);
		},
	},
		],
	},
	{ 
		title: "Leaderboards",
		menuItems: [
			{title: "Gold",
			menuItems: [
				{title: "Balance",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 0)).openOn(map);},},
				{title: "Demonetized coins",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 4)).openOn(map);},},
				{title: "Gold smelted",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 6)).openOn(map);},},
				{title: "Tax paid",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 17)).openOn(map);},},
			],},
			{title: "Food",
			menuItems: [
				{title: "Food consumed",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 5)).openOn(map);},},
				{title: "Grain harvested",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 7)).openOn(map);},},
				{title: "Vegetables harvested",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 18)).openOn(map);},},
			],},
			{title: "Food - Animals",
			menuItems: [
				{title: "Moose killed",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 1)).openOn(map);},},
				{title: "Bears killed",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 2)).openOn(map);},},
				{title: "Fish fished",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 3)).openOn(map);},},
			],},
			{title: "Other",
			menuItems: [
				{title: "Level",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 8)).openOn(map);},},
				{title: "Auctions created",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 9)).openOn(map);},},
				{title: "Buildings demolished",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 10)).openOn(map);},},
				{title: "Discoveries",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 11)).openOn(map);},},
				{title: "Fires put out",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 12)).openOn(map);},},
				{title: "Pearls found",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 13)).openOn(map);},},
				{title: "Trades",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 14)).openOn(map);},},
				{title: "POS Blocks found",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 15)).openOn(map);},},
				{title: "Prestige",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 16)).openOn(map);},},
			],},
			{title: "Sustained",
			menuItems: [
				{title: "Sustained blocks",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 19)).openOn(map);},},
				{title: "Sustained food",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 20)).openOn(map);},},
				{title: "Sustained gold",onClick: () => {var popup = L.popup({maxWidth: 1000, className: 'popup_without_tip'}).setLatLng(xy([0, 0])).setContent(generateTable(Account_data, 21)).openOn(map);},},
			],},
		],
	},
	],
}).addTo(map);
//<!-- https://github.com/BenPortner/leaflet-burgermenu --> 
map.setView( [0, 0], -1)
</script>
</body>
</html>
